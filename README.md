# 台灣股票選股系統

一個互動式的多因子選股系統，支援自定義股票列表、策略參數和日期範圍。

## 功能特點

- ✅ **圖形界面（GUI）**：現代化的桌面應用，操作直觀
- ✅ **命令行界面（CLI）**：適合自動化腳本使用
- ✅ **自定義股票列表**：可選擇任意台灣股票（格式：2330.TW）
- ✅ **靈活策略參數**：可調整均線週期、成交量倍數、營收標準等
- ✅ **多因子選股**：結合趨勢、動量、籌碼面、基本面
- ✅ **風險管理**：自動計算ATR基礎停損價
- ✅ **詳細報告**：輸出CSV報告，包含所有指標和信號

## 安裝

```bash
pip install -r requirements.txt
```

## 使用方式

### 🖥️ 方式一：GUI圖形界面（推薦）

**啟動應用：**
```bash
python app.py
```

或者雙擊 `啟動應用.py` 文件

**操作步驟：**
1. 在左側「股票列表」輸入要分析的股票（例如：`2330.TW 2317.TW`）
2. 設定「日期範圍」（過去天數，預設365天）
3. 調整「策略參數」（可選，或使用預設值）
4. 點擊「🚀 運行選股策略」按鈕
5. 在右側查看結果表格
6. 點擊「💾 導出CSV報告」保存結果

### 💻 方式二：命令行界面

```bash
python main.py
```

然後在選單中選擇：
1. **選項 6** - 使用預設設定快速開始
2. **選項 4** - 運行選股策略

### 完整操作流程

1. **設定股票列表**（選項 1）
   - 輸入股票代號，例如：`2330.TW 2317.TW 2454.TW`
   - 或輸入：`2330.TW,2317.TW,2454.TW`
   - 系統會自動補上 `.TW` 後綴（如果只輸入數字）

2. **設定日期範圍**（選項 2）
   - 選擇過去N天，或自訂起始和結束日期

3. **設定策略參數**（選項 3）
   - 短期均線週期（預設20日）
   - 長期均線週期（預設60日）
   - 成交量倍數（預設1.5）
   - 最低營收年增率（預設10%）
   - ATR週期（預設14日）
   - 停損ATR倍數（預設2.0）

4. **運行選股策略**（選項 4）
   - 自動獲取數據、運行策略、生成報告

5. **查看當前設定**（選項 5）
   - 查看所有已設定的參數

## 選股策略邏輯

系統使用以下條件篩選股票：

1. **趨勢條件**：收盤價 > MA20 > MA60
2. **動量條件**：成交量 > 1.5倍（可調整）均量
3. **籌碼條件**：投信買超 > 0
4. **基本面條件**：營收年增率 > 10%（可調整）
5. **風險管理**：自動計算ATR基礎停損價

## 輸出說明

運行完成後會生成 `daily_report.csv`，包含以下欄位：

- `Date`: 日期
- `Stock_ID`: 股票代號
- `Open/High/Low/Close`: 價格數據
- `Volume`: 成交量
- `MA20/MA60`: 移動平均線
- `ATR`: 平均真實波幅
- `Foreign_Net_Buy`: 外資買賣超（模擬數據）
- `Trust_Net_Buy`: 投信買賣超（模擬數據）
- `Revenue_YoY`: 營收年增率（模擬數據）
- `Stop_Loss_Price`: 停損價格
- `Risk_Reward_Ratio`: 風險報酬比
- 各項條件是否滿足（True/False）

## 注意事項

⚠️ **重要說明**：
- `Foreign_Net_Buy`、`Trust_Net_Buy`、`Revenue_YoY` 為模擬數據
- 價格和成交量數據來自真實的 yfinance API
- 建議將此系統作為輔助工具，投資前請自行研究

## 常見台灣股票代號

- 2330.TW - 台積電
- 2317.TW - 鴻海
- 2454.TW - 聯發科
- 2308.TW - 台達電
- 2412.TW - 中華電
- 2303.TW - 聯電

## 範例

### 範例1：分析單支股票

1. 選擇「1. 設定股票列表」
2. 輸入：`2330.TW`
3. 選擇「6. 使用預設設定快速開始」
4. 選擇「4. 運行選股策略」

### 範例2：自訂策略參數

1. 設定股票列表：`2330.TW 2317.TW 2454.TW`
2. 選擇「3. 設定策略參數」
   - 短期均線：30日
   - 長期均線：90日
   - 成交量倍數：2.0
   - 最低營收年增率：15%
3. 運行策略

## 技術架構

- `data_fetcher.py`: 數據獲取模組（使用 yfinance）
- `alpha_strategy.py`: 策略邏輯模組（多因子選股）
- `main.py`: 互動式主程式

## 授權

本專案僅供學習和研究使用。

